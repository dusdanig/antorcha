<h1>Messages</h1>

<% if @transaction %>
  <p class="intro">
    of <%= link_to_transaction @transaction %>.
    Create a <%= link_to "New Message", new_transaction_message_path(@transaction)%>.
  </p>
<% end %>

<% if @steps_to_start_with %>
<h2>Start a new step</h2>

<ul>
<% @steps_to_start_with.each do |step| %>
  <li><%= link_to "Start: #{step.title} (van Definition: #{step.definition.title})", new_step_message_url(step)%></li>
<% end %>
</ul>
<h2>Messages</h2>
<% end %>



<p>
  <%= link_to "inbox", :search => {:inbox => true} %> |
  <%= link_to "outbox", :search => {:outbox => true} %>
</p>

<table>
  <tr>
    <th>Message title</th>
    <th>Step title</th>
    <th>Definition title</th>
    <th>Direction</th>
  </tr>

<% @messages.each do |message| %>
  <tr class="message <%= message.shown? %>">
    <td><%= link_to h(message.title), message %></td>
    <td><%= link_to_step message.step %></td>
    <td><%= link_to h(message.step.definition.title), message.step.definition %></td>
    <td><%= message.incoming? ? "In" : "Out" %> <%= l(message.sent_at, :format => :short) if message.sent? %></td>
  </tr>
<% end %>
</table>
