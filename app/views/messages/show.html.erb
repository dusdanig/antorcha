<h1>Message <strong><%=h @message.title  %></strong></h1>
<p class="intro">
  in transaction <%= link_to_transaction @message.transaction %>
  which follows definition <%= link_to_definition @message.step.definition %>
  based on step <%= link_to_step @message.step %>
</p>
<p>Message is
  <% if @message.incoming? %>
    received at <%=h l(@message.created_at, :format => :short) %>.
  <% else %>
    <% if @message.sent? %>
      sent at <%=h l(@message.sent_at, :format => :short) %>
      <% if @message.delivered? %>
        and received at <%=h l(@message.delivered_at, :format => :short) %>.
      <% else %>
        and not received.
      <% end %>
    <% else %>
      is a concept and not yet sent.
    <% end %>
  <% end %>
</p>

<p>
  <b>Body:</b>
  <%=h @message.body %>
</p>

<div class="actions">
<% unless @message.sent? %>
  <%= button_to 'Send Message', message_delivery_path(@message), :method => :post %> |
<% end %>
<%= link_to_edit_message @message %>
</div>